<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Daily Path</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&display=swap" rel="stylesheet">
<style>
:root {
  --cream: #f2eee8;
  --pink: #e8c0c7;
  --silver: #bfc0c6;
  --green: #8fbf8a;
  --yellow: #f2d97f;
  --red: #d97b7f;
  --text: #3b3b3b;
  --archive-color: #a65a6d;
}

body {
  margin:0;
  font-family:'Playfair Display', serif;
  background: linear-gradient(var(--cream), var(--pink));
  color: var(--text);
}

header {
  text-align:center;
  padding:3rem 1rem;
}

header h1 { font-size:2.5rem; margin-bottom:0.3rem; }
header p { opacity:0.7; margin:0.2rem 0; }

header a {
  text-decoration:none;
  color: var(--archive-color);
  font-weight:600;
  transition:0.2s;
}
header a:hover { color: var(--text); }

.container { max-width:900px; margin:auto; padding:2rem; }

.card {
  background: rgba(255,255,255,0.9);
  border-radius:12px;
  padding:2rem;
  margin-bottom:2rem;
  box-shadow:0 10px 30px rgba(0,0,0,0.08);
}

h2 { margin-bottom:1rem; cursor:pointer; }

.task {
  display:flex;
  align-items:center;
  margin-top:0.8rem;
  padding:0.6rem;
  background:#fff;
  border-left:4px solid var(--silver);
  border-radius:6px;
}

.task.integral { border-color:#b07a8a; }
.task.should { border-color:#9c9cab; }
.task.optional { border-color:#cfcfd4; }

.task input[type="checkbox"] { width:auto; margin-right:0.8rem; }
.task select { margin-left:auto; border-radius:12px; border:1px solid var(--silver); padding:0.3rem; }

.hidden { display:none; }

.path { font-size:1.2rem; margin-bottom:1rem; }

footer {
  text-align:center;
  padding:3rem 1rem;
  font-size:0.9rem;
  opacity:0.6;
}

/* Morning Check-In Buttons */
.button-group {
  display:flex;
  gap:1rem;
  margin-top:0.5rem;
  margin-bottom:1rem;
}

.button-group button {
  flex:1;
  padding:0.6rem;
  border:1px solid var(--silver);
  border-radius:20px;
  background: var(--cream);
  font-family:inherit;
  cursor:pointer;
  transition:0.2s;
}

.button-group button.selected {
  background: var(--pink);
  border-color: var(--pink);
  color:#fff;
}

.button-group button:hover {
  background: var(--pink);
  color:#fff;
}

/* Photo */
.photo-box {
  width:60%;
  display:flex;
  justify-content:center;
  margin-bottom:1.5rem;
}

.photo {
  width:60%;
  border:5px solid var(--cream);
  border-radius:12px;
  transition: transform 0.3s ease;
}

.photo:hover { transform: scale(0.97); }

/* Weekly task input & buttons */
#weeklyInput {
  width: 100%;
  padding:0.8rem;
  border-radius:12px;
  border:1px solid var(--silver);
  font-family:inherit;
  margin-bottom:0.5rem;
}

#importanceSelect {
  width: 100%;
  padding:0.6rem;
  margin-bottom:0.8rem;
  border-radius:12px;
  border:1px solid var(--silver);
  font-family:inherit;
}

#addWeeklyTask, #resetWeekly {
  padding:0.8rem 1.6rem;
  border:none;
  border-radius:20px;
  font-family:inherit;
  cursor:pointer;
  transition:0.2s;
}

#addWeeklyTask { background: var(--silver); }
#addWeeklyTask:hover { background: var(--pink); }

#resetWeekly { background:#d97b7f; color:#fff; }
#resetWeekly:hover { background:#b75a63; }

/* Collapsible content */
#weeklyContent { display:block; overflow:hidden; transition:max-height 0.3s ease; }
</style>
</head>
<body>

<header>
  <h1>Daily Path</h1>
  <p>Structure without punishment</p>
  <p><a href="archive.html">View Archive</a></p>
</header>

<div class="container">

  <!-- Photo -->
  <div class="photo-box">
    <img src="cropped_deer.jpg" alt="Your photo" class="photo">
  </div>

  <!-- Weekly Tasks -->
  <div class="card">
    <h2 onclick="toggleWeekly()">Weekly Tasks â¬‡</h2>
    <div id="weeklyContent">
      <input type="text" id="weeklyInput" placeholder="Enter a weekly task">
      <select id="importanceSelect">
        <option value="integral">Integral</option>
        <option value="should">Should Do</option>
        <option value="optional">Would Like To</option>
      </select>
      <div style="display:flex; gap:0.5rem; margin-bottom:0.5rem;">
        <button id="addWeeklyTask">Add Task</button>
        <button id="resetWeekly">Reset All</button>
      </div>
      <div id="weeklyList"></div>
    </div>
  </div>

  <!-- Daily Prioritising -->
  <div class="card">
    <h2>Daily Prioritising</h2>
    <p>Select tasks for today and adjust importance if needed:</p>
    <div id="dailyChoices"></div>
  </div>

  <!-- Morning Check-In -->
  <div class="card">
    <h2>Morning Check-In</h2>

    <p>How much did you sleep?</p>
    <div class="button-group" id="sleepButtons">
      <button data-value="good">Enough</button>
      <button data-value="bad">Very little</button>
    </div>

    <p>How do you feel?</p>
    <div class="button-group" id="feelingButtons">
      <button data-value="good">Okay / Good</button>
      <button data-value="low">Low / Fragile</button>
    </div>

    <p>Did you wake up on time?</p>
    <div class="button-group" id="wakeButtons">
      <button data-value="yes">Yes</button>
      <button data-value="no">No</button>
    </div>

    <button onclick="decidePath()">Begin Day</button>
  </div>

  <!-- Day View -->
  <div class="card hidden" id="day">
    <div class="path" id="pathTitle"></div>
    <div id="dayTasks"></div>
    <button onclick="archiveDay()">Archive Day</button>
  </div>

</div>

<footer>Missing a day is natural.</footer>

<script>
let weeklyTasks = JSON.parse(localStorage.getItem("weeklyTasks")) || [];
let dailyTasks = [];
let sleep="", feeling="", wake="";

// Collapsible weekly section
function toggleWeekly(){
  const content = document.getElementById("weeklyContent");
  if(content.style.display==="none") content.style.display="block";
  else content.style.display="none";
}

// Add weekly task
const weeklyInput = document.getElementById("weeklyInput");
const importanceSelect = document.getElementById("importanceSelect");
const weeklyList = document.getElementById("weeklyList");

function saveWeekly(){ localStorage.setItem("weeklyTasks", JSON.stringify(weeklyTasks)); }

document.getElementById("addWeeklyTask").addEventListener("click", ()=>{
  const text = weeklyInput.value.trim();
  if(!text) return;
  const importance = importanceSelect.value;
  weeklyTasks.push({text, importance, done:false});
  weeklyInput.value="";
  renderWeekly();
  saveWeekly();
  renderDailyChoices();
});

// Reset weekly tasks
document.getElementById("resetWeekly").addEventListener("click", ()=>{
  if(confirm("Are you sure you want to delete all weekly tasks? This cannot be undone.")){
    weeklyTasks=[];
    saveWeekly();
    renderWeekly();
    renderDailyChoices();
  }
});

function renderWeekly(){
  weeklyList.innerHTML="";
  weeklyTasks.forEach(t=>{
    const div=document.createElement("div");
    div.className="task "+t.importance;
    div.textContent = t.text + " (" + t.importance + ")";
    weeklyList.appendChild(div);
  });
}

// Daily selection
const dailyChoices = document.getElementById("dailyChoices");
function renderDailyChoices(){
  dailyChoices.innerHTML="";
  weeklyTasks.forEach((t,i)=>{
    const div=document.createElement("div");
    div.className="task "+t.importance;
    div.innerHTML = `<input type="checkbox" data-index="${i}"> ${t.text} 
      <select data-index="${i}" onchange="updateDailyImportance(this)">
        <option value="integral" ${t.importance==='integral'?'selected':''}>Integral</option>
        <option value="should" ${t.importance==='should'?'selected':''}>Should Do</option>
        <option value="optional" ${t.importance==='optional'?'selected':''}>Would Like To</option>
      </select>`;
    dailyChoices.appendChild(div);
  });
}

function updateDailyImportance(sel){
  const i = parseInt(sel.dataset.index);
  weeklyTasks[i].importance = sel.value;
  renderWeekly();
}

// Morning Check-In buttons
function setupButtons(id, variableName){
  document.querySelectorAll(`#${id} button`).forEach(btn=>{
    btn.addEventListener("click", ()=>{
      window[variableName]=btn.dataset.value;
      btn.parentNode.querySelectorAll("button").forEach(b=>b.classList.remove("selected"));
      btn.classList.add("selected");
    });
  });
}

setupButtons("sleepButtons","sleep");
setupButtons("feelingButtons","feeling");
setupButtons("wakeButtons","wake");

function decidePath(){
  dailyTasks=[];
  dailyChoices.querySelectorAll("input[type=checkbox]").forEach(input=>{
    if(input.checked){
      const i=parseInt(input.dataset.index);
      dailyTasks.push({...weeklyTasks[i]});
    }
  });

  let path="green";
  if(sleep==="bad" || feeling==="low") path="yellow";
  if(sleep==="bad" && wake==="no") path="red";
  showDay(path);
}

function showDay(path){
  document.getElementById("day").classList.remove("hidden");
  const title = document.getElementById("pathTitle");
  const container = document.getElementById("dayTasks");
  container.innerHTML="";
  title.textContent = path==="green"?"Green Path â€” Everything":path==="yellow"?"Yellow Path â€” Enough is enough":"Red Path â€” Only essentials";

  dailyTasks.forEach((t,i)=>{
    const include = path==="green" || (path==="yellow" && t.importance!=="optional") || (path==="red" && t.importance==="integral");
    if(include){
      const div=document.createElement("div");
      div.className=`task ${t.importance}`;
      div.innerHTML=`<input type="checkbox" ${t.done?"checked":""} onchange="toggleDone(${i})"> ${t.text} (${t.importance})`;
      container.appendChild(div);
    }
  });
  localStorage.setItem("currentPath", path);
}

function toggleDone(i){ dailyTasks[i].done=!dailyTasks[i].done; }

function archiveDay(){
  const archive = JSON.parse(localStorage.getItem("archive"))||[];
  archive.push({
    date: new Date().toLocaleDateString(),
    path: localStorage.getItem("currentPath"),
    tasks: [...dailyTasks]
  });
  localStorage.setItem("archive", JSON.stringify(archive));
  dailyTasks=[];
  renderDailyChoices();
  alert("Day archived ðŸŒ™");
  document.getElementById("day").classList.add("hidden");
}
</script>
</body>
</html>
