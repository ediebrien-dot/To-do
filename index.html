<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Daily Path</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&display=swap" rel="stylesheet">
<style>
:root {
  --cream: #f2eee8;
  --pink: #e8c0c7;
  --silver: #bfc0c6;
  --green: #8fbf8a;
  --yellow: #f2d97f;
  --red: #d97b7f;
  --text: #3b3b3b;
  --archive-color: #cfa7b0; /* slightly different pink for archive link */
}

body {
  margin:0;
  font-family:'Playfair Display', serif;
  background: linear-gradient(var(--cream), var(--pink));
  color: var(--text);
}

header {
  text-align:center;
  padding:3rem 1rem;
}

header h1 { font-size:2.5rem; margin-bottom:0.3rem; }
header p { opacity:0.7; margin:0.2rem 0; }

header a {
  text-decoration:none;
  color: var(--archive-color);
  font-weight:600;
  transition:0.2s;
}
header a:hover { color: var(--text); }

.container { max-width:900px; margin:auto; padding:2rem; }

.card {
  background: rgba(255,255,255,0.9);
  border-radius:12px;
  padding:2rem;
  margin-bottom:2rem;
  box-shadow:0 10px 30px rgba(0,0,0,0.08);
}

h2 { margin-bottom:1rem; }

.task {
  display:flex;
  align-items:center;
  margin-top:0.8rem;
  padding:0.6rem;
  background:#fff;
  border-left:4px solid var(--silver);
  border-radius:6px;
}

.task.integral { border-color:#b07a8a; }
.task.should { border-color:#9c9cab; }
.task.optional { border-color:#cfcfd4; }

.task input { width:auto; margin-right:0.8rem; }

.hidden { display:none; }

.path { font-size:1.2rem; margin-bottom:1rem; }

footer {
  text-align:center;
  padding:3rem 1rem;
  font-size:0.9rem;
  opacity:0.6;
}

/* Morning Check-In Buttons */
.button-group {
  display:flex;
  gap:1rem;
  margin-top:0.5rem;
  margin-bottom:1rem;
}

.button-group button {
  flex:1;
  padding:0.6rem;
  border:1px solid var(--silver);
  border-radius:20px;
  background: var(--cream);
  font-family:inherit;
  cursor:pointer;
  transition:0.2s;
}

.button-group button.selected {
  background: var(--pink);
  border-color: var(--pink);
  color:#fff;
}

.button-group button:hover {
  background: var(--pink);
  color:#fff;
}

/* Photo */
.photo-box {
  width:100%;
  display:flex;
  justify-content:center;
  margin-bottom:1.5rem;
}

.photo {
  width:100%;
  max-width:500px;
  border:5px solid var(--cream);
  border-radius:12px;
  transition: transform 0.3s ease;
}

.photo:hover { transform: scale(0.97); }

/* Weekly task input & button */
#weeklyInput {
  width: 100%;
  padding:0.8rem;
  border-radius:12px;
  border:1px solid var(--silver);
  font-family:inherit;
  margin-bottom:0.8rem;
}

#addWeeklyTask {
  padding:0.8rem 1.6rem;
  border:none;
  border-radius:20px;
  background: var(--silver);
  font-family:inherit;
  cursor:pointer;
  transition:0.2s;
}

#addWeeklyTask:hover { background: var(--pink); }
</style>
</head>
<body>

<header>
  <h1>Daily Path</h1>
  <p>Structure without punishment</p>
  <p><a href="archive.html">View Archive</a></p>
</header>

<div class="container">

  <!-- Photo -->
  <div class="photo-box">
    <img src="cropped_deer.jpg" alt="Your photo" class="photo">
  </div>

  <!-- Weekly Tasks -->
  <div class="card">
    <h2>Weekly Tasks</h2>
    <input type="text" id="weeklyInput" placeholder="Enter a weekly task">
    <button id="addWeeklyTask">Add</button>
    <div id="weeklyList"></div>
  </div>

  <!-- Daily Prioritising -->
  <div class="card">
    <h2>Daily Prioritising</h2>
    <p>Select tasks for today:</p>
    <div id="dailyChoices"></div>
  </div>

  <!-- Morning Check-In -->
  <div class="card">
    <h2>Morning Check-In</h2>

    <p>How much did you sleep?</p>
    <div class="button-group" id="sleepButtons">
      <button data-value="good">Enough</button>
      <button data-value="bad">Very little</button>
    </div>

    <p>How do you feel?</p>
    <div class="button-group" id="feelingButtons">
      <button data-value="good">Okay / Good</button>
      <button data-value="low">Low / Fragile</button>
    </div>

    <p>Did you wake up on time?</p>
    <div class="button-group" id="wakeButtons">
      <button data-value="yes">Yes</button>
      <button data-value="no">No</button>
    </div>

    <button onclick="decidePath()">Begin Day</button>
  </div>

  <!-- Day View -->
  <div class="card hidden" id="day">
    <div class="path" id="pathTitle"></div>
    <div id="dayTasks"></div>
    <button onclick="archiveDay()">Archive Day</button>
  </div>

</div>

<footer>Missing a day is natural.</footer>

<script>
let weeklyTasks = JSON.parse(localStorage.getItem("weeklyTasks")) || [];
let dailyTasks = [];
let sleep="", feeling="", wake="";

// Add weekly task
const weeklyInput = document.getElementById("weeklyInput");
const weeklyList = document.getElementById("weeklyList");

function saveWeekly() { localStorage.setItem("weeklyTasks", JSON.stringify(weeklyTasks)); }

document.getElementById("addWeeklyTask").addEventListener("click", ()=>{
  const text = weeklyInput.value.trim();
  if(!text) return;
  weeklyTasks.push({text, importance:"integral", done:false}); // default importance
  weeklyInput.value="";
  saveWeekly();
  renderWeekly();
});

function renderWeekly(){
  weeklyList.innerHTML="";
  weeklyTasks.forEach((t,i)=>{
    const div = document.createElement("div");
    div.className="task integral";
    div.textContent = t.text;
    weeklyList.appendChild(div);
  });
}

renderWeekly();

// Daily selection from weekly
const dailyChoices = document.getElementById("dailyChoices");
function renderDailyChoices(){
  dailyChoices.innerHTML="";
  weeklyTasks.forEach((t,i)=>{
    const div = document.createElement("div");
    div.className="task integral";
    div.innerHTML=`<input type="checkbox" data-index="${i}"> ${t.text}`;
    dailyChoices.appendChild(div);
  });
}
renderDailyChoices();

function decidePath() {
  // gather selected tasks
  dailyTasks = [];
  dailyChoices.querySelectorAll("input[type=checkbox]").forEach(input=>{
    if(input.checked){
      const i = parseInt(input.dataset.index);
      dailyTasks.push({...weeklyTasks[i]});
    }
  });

  // path logic
  let path = "green";
  if(sleep==="bad" || feeling==="low") path="yellow";
  if(sleep==="bad" && wake==="no") path="red";
  showDay(path);
}

// Morning Check-In buttons
function setupButtons(id, variableName) {
  document.querySelectorAll(`#${id} button`).forEach(btn=>{
    btn.addEventListener("click", ()=>{
      window[variableName] = btn.dataset.value;
      btn.parentNode.querySelectorAll("button").forEach(b=>b.classList.remove("selected"));
      btn.classList.add("selected");
    });
  });
}

setupButtons("sleepButtons","sleep");
setupButtons("feelingButtons","feeling");
setupButtons("wakeButtons","wake");

function showDay(path){
  document.getElementById("day").classList.remove("hidden");
  const title = document.getElementById("pathTitle");
  const container = document.getElementById("dayTasks");
  container.innerHTML="";
  title.textContent = path==="green"?"Green Path â€” Everything":path==="yellow"?"Yellow Path â€” Enough is enough":"Red Path â€” Only essentials";

  dailyTasks.forEach((t,i)=>{
    const include = path==="green" || (path==="yellow" && t.importance!=="optional") || (path==="red" && t.importance==="integral");
    if(include){
      const div = document.createElement("div");
      div.className=`task ${t.importance}`;
      div.innerHTML=`<input type="checkbox" ${t.done?"checked":""} onchange="toggleDone(${i})"> ${t.text}`;
      container.appendChild(div);
    }
  });
  localStorage.setItem("currentPath", path);
}

function toggleDone(i){ dailyTasks[i].done=!dailyTasks[i].done; }

function archiveDay(){
  const archive = JSON.parse(localStorage.getItem("archive"))||[];
  archive.push({
    date: new Date().toLocaleDateString(),
    path: localStorage.getItem("currentPath"),
    tasks: [...dailyTasks]
  });
  localStorage.setItem("archive", JSON.stringify(archive));
  dailyTasks=[];
  renderDailyChoices(); // reset daily selection
  alert("Day archived ðŸŒ™");
  document.getElementById("day").classList.add("hidden");
}
</script>

</body>
</html>
